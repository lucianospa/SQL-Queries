DROP TABLE EXEMPLO;

CREATE TABLE EXEMPLO
( CHAVE number(10),
  TIPO varchar2(10),
  VALOR_IOF number(10),
  VALOR_MOV number(10),
  DESCR varchar2(25),
  CANCELA_RESP varchar2(10),
  CHAVE_EMISSAO number(10)
);

INSERT INTO EXEMPLO VALUES (1, 'EMISSAO', 10, 1000, '', '',0);
INSERT INTO EXEMPLO VALUES (2, 'EMISSAO', 10, 1000, '', '',0);
INSERT INTO EXEMPLO VALUES (3, 'CANCELA', 0, -1000, 'CANCELANDO', 'MANUEL',1);
INSERT INTO EXEMPLO VALUES (4, 'EMISSAO', 10, 1000, '', '',0);
INSERT INTO EXEMPLO VALUES (5, 'CANCELA', 0, -1000, 'CANCELANDO', 'ARI', 4);
INSERT INTO EXEMPLO VALUES (6, 'EMISSAO', 10, 1000, '', '',0);
INSERT INTO EXEMPLO VALUES (7, 'EMISSAO', 10, 1000, '', '',0);
INSERT INTO EXEMPLO VALUES (8, 'CANCELA', 0, -1000, 'CANCELANDO', 'REGIS',6); 

SELECT * FROM exemplo;

SELECT EMISSAO_CHAVE CHAVE, 
       SUM(EMISSAO_IOF) VALOR_IOF, 
       SUM(EMISSAO_MOVIMENTO) VALOR_MOV,
       MAX(CANCELAMENTO_CHAVE) CHAVE_CANCEL,
       SUM(CANCELAMENTO_IOF) CANCEL_VALOR_IOF,
       SUM(CANCELAMENTO_MOVIMENTO) CANCEL_VALOR_MOV,
       MAX(CANCELAMENTO_DESCR) CANCEL_DESCR,
       MAX(CANCELAMENTO_CANCELA_RESP) CANCEL_RESP
FROM ( 
        SELECT 
               DECODE(TIPO, 'EMISSAO', CHAVE, CHAVE_EMISSAO) EMISSAO_CHAVE,
               DECODE(TIPO, 'EMISSAO', VALOR_IOF, NULL) EMISSAO_IOF,
               DECODE(TIPO, 'EMISSAO', VALOR_MOV, NULL) EMISSAO_MOVIMENTO,
               DECODE(TIPO, 'CANCELA', CHAVE, NULL) CANCELAMENTO_CHAVE,
               DECODE(TIPO, 'CANCELA', VALOR_IOF, NULL) CANCELAMENTO_IOF,
               DECODE(TIPO, 'CANCELA', VALOR_MOV, NULL) CANCELAMENTO_MOVIMENTO,
               DECODE(TIPO, 'CANCELA', DESCR, NULL) CANCELAMENTO_DESCR,
               DECODE(TIPO, 'CANCELA', CANCELA_RESP, NULL) CANCELAMENTO_CANCELA_RESP
       FROM EXEMPLO
       ) TAB
 GROUP BY EMISSAO_CHAVE